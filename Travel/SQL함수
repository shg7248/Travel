create or replace function replaceFac(vcolumn varchar2, cnum varchar2)
return varchar2
is
vfac varchar2(100);
begin
	with a as (
	    select regexp_substr(vcolumn, '[^,]+', 1, level) as fac
		from dual
		connect by level <= length(regexp_substr(vcolumn, '[^,]+', 1, level)) + 1
	),
	b as (
	    select fnum, name, fgroup 
	    from FACILITY f
	    inner join a
	    on f.fnum = a.fac
	)
	select listagg(name, ',') within group(order by name) into vfac
	from b
	group by fgroup;
	
	DBMS_OUTPUT.PUT_LINE(vfac);
	
	return vfac;
end;

dsffsddsffds